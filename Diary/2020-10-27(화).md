### 2020-10-27

-----
##### 1. 학습 날짜
- 2020-10-27

-----
##### 2. 학습 시간
- 08:00 ~ 20:30

-----
###### 3. 학습 범위 및 주제
- 문제풀이
- 웹서버 설계 및 구현

-----
##### 4. 동료 학습 방법
- slack

-----
##### 5. 학습 목표
- 서버의 동작 방식을 익히고 그에 맞게 설계 및 구현을 한다.
- 문제풀기

-----
##### 6. 과제 제출
- https://github.com/get-Pork-Belly/Webserv
- https://github.com/leecoleecolee/ProblemSolving/tree/sanam

-----
##### 7. 상세 학습 내용
- 웹서버
    - 오늘 웹서버는 많이 하지 못했다. 그 일단 오전에는 오후에 어떤 작업을 어떻게 할지에 대해 이야기를 했다. 결론은 어제 만든 구조를 그대로 이용해서 구체화 나가는것. 오후에는  메인 로직을 밀고나가는 2명, 사이드로 한명 나눠서 했고 나는 사이드로 빠져서 receiveRequest가 끝나면 이후에 작업할 내용들을 코딩하는 부분을 맡았다. 하지만 이 부분에 대한 진도가 전혀 나가지 못했다... 
    - receiveRequest가 끝나면 읽은 리퀘스트의 uri를 이용해서 어떤 파일을 open 하고 연 파일을 `fd_table`에 적용시키고 타입, 리퀘스트 인포 등을 설정해줘야한다. 난 이 부분을 간과하고 설계, 코딩을 해서 거의 3시간을 통째로 날려버렸다...

- receiveRequest이후의 작업 순서.
1. receiveRequest이후 ReqInfo를 검사한다. 만약 이 값이 `COMPLETE` 라면 이후의 작업을 하고 만약 아니라면 그대로 끝난다.
2. 가장 먼저 할 일은 `URI`를 읽고 `root`를 찾아내는것.
    1. root를 찾는 부분에서 주의할 것은 `location`의 존재 유무이다.
    2. `location` 에 대한 파싱을 먼저 하자.
3. `root` 를 알아냈다면, 이후 요청한 데이터의 `파일`, `폴더`, `CGI` 여부를 알아내자.
    - `CGI` 여부를 알아내기 위해서는 `nginx.conf` 파일에서 가져온 정보가 필요하다. `cgi`를 키로 하는 값을 찾고 그 값에 해당하는 `extension`을 request가 요청했다면 `cgi`
    - `파일`, `폴더` 여부
        - 일단 가장 먼저 `uri`의 마지막 문자를 확인하자 만약 `/`라면 폴더, 아니라면 파일

    - `파일`인 경우에는 파로 open하고 `fd_table`에 세팅하고 readset 등등 을 세팅해주자.

    - `폴더`라면
        1. `index.html` 파일의 존재여부를 확인한다. 만약 있다면 이 위의 `파일`과 같은 작업을 해주자.
        2. `index` 지시어가 있는지를 찾고, 만약 해당하는 값에 현재 폴더의 파일이 있다면 그 파일을 위와 같은 작업을 햊주ㅏ.
        3. 1, 2의 경우가 모두 아니라면 `autoindex` 를 확인한다. 만약 `on`이라면 현재 폴더 정보를 읽는 작업을 해주자 그도 아니라면 403 error를 쏘자.



 -----
##### 8. 오늘 학습 내용에 대한 개인적인 총평
- 나는 너무 멍청하다.. 

-----

##### 9. 다음 학습 계획

- 웹서버 설계 및 구현
- 문제풀이
