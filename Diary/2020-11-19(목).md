### 2020-11-19

-----
##### 1. 학습 날짜
- 2020-11-19

-----
##### 2. 학습 시간
- 08:00 ~ 20:00

-----
###### 3. 학습 범위 및 주제
- 웹서버 설계 및 구현

-----
##### 4. 동료 학습 방법
- slack

-----
##### 5. 학습 목표
- 서버의 동작 방식을 익히고 그에 맞게 설계 및 구현을 한다.

-----
##### 6. 과제 제출
- https://github.com/get-Pork-Belly/Webserv

-----
##### 7. 상세 학습 내용

- 웹서버
    - 어제 모든 테스터를 돌려보지는 못하고 일부분에 대해서만 테스트를 진행했었다. 오늘 오전에는 어제 실패한 이슈를 우선적으로 해결해봤다. 첫 번째로 여러 명의 클라이언트가 서버에 요청을 보낼 때 100퍼센트 서버가 터졌다. 이 문제는 딱 봐도 hanging fd가 문제일 것으로 추측이 되었고, 이 부분을 집중적으로 파봤다. errno을 출력해보니 역시나 fd가 모자라서 터지는 문제였고, `lsof -p process-id`로 알아본 결과 클라이언트에 대한 fd가 종료가 되지 않고 있었다. 따라서 클라이언트가 언제 종료 되는지를 살펴봤는데, 우리의 경우 한번 리퀘스트를 읽고 그 다음번에  다시 한번 읽음으로써 클라이언트의 상태를 검사하는데 코드가 추가가 될 때 이 부분을 신경쓰지 않았었고 따라서 클라이언트 fd가 종료되지 않은 채 계속 남아있는 것이었음. 따라서 클라이언트에 대해서 read_set을 올려주니깐 문제가 해결되었다.
    - 20개의 클라이언트가 각각이 5000번의 요청을 하는 경우.
       - 이 문제는 총 십만번의 요청을 서버가 처리해야하는 경우다. 솔직히 이건 아무런 문제없이 통과할 줄 알았건만,, 우리의 테스터가 생각보다 너무 많이 느려서 이 테스트를 통과하는데 시간이 한참 걸려도 정말 너무 한참 걸렸다. 따라서 요처을 받는 부분에 대한 효율성을 급격히 늘려야 할 필요가 있었다. 속도를 개선하기 위해서 함수 각각의 소요시간을 측정하는 함수를 만들고 얼마나 걸렸는데 시간을 재보니 read 함수를 호출하는 부분에서 시간의 병목이 일어나는 것을 확인했다. 이 문제는 다른게 아닌 read 를 하기 전에 무조건 memset을 버퍼 사이즈 만큼 하면서 생기는 문제였다. 따라서 read의 리턴값에 NULL을 넣어줌으로써 해결했다.
       - 위의 문제를 해결한줄 알았지만... 이상하게 버퍼가 지워지지 않는 현상?이 발생했다.... 하...

 -----
##### 8. 오늘 학습 내용에 대한 개인적인 총평
- 막바지에 온 줄 알았지만 아직 많은 것이 남아있었다...

-----

##### 9. 다음 학습 계획

- 웹서버 설계 및 구현
