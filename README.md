### vim 사용법

[vim tips wiki](https://vim.fandom.com/wiki/Vim_Tips_Wiki)

##### 1. 파일버퍼 사용하기.

- 여러 파일을 한번에 수정해야 하는 경우가 빈번하다. 이런 경우 하나의 파일을 수정하고 닫고.. 다른 파일을 또 열고 닫고.. 다시 다른 파일을 여는 방식으로 코딩을 하면 매우 귀찮다.... 따라서 한번에 파일을 열고 작업을 하는 방법을 알아보자.

- 이런 경우를 위해 vim에는 파일버퍼라는 개념이 있다. c언어에서 파일디스크립터를 이용해서 파일을 다루듯 vim에서는 버퍼라는 개념을 이용해서 다루는 것. 개념이라고는 했지만 별거 없다. 그냥 여러 파일을 한번에 수정할 수 있게 해주는 것.

- 여러 파일을 여는 방법은 매우 간단하다.  ```vim a.c b.c c.c``` 이렇게 타이핑을 하고 엔터를 누르면 세 개의 파일이 동시에 열린다. 하지만 우리한테 보이는 파일은 ```a.c``` 파일 밖에는 없다. ```b.c```와 ```c.c```는 도대체 어디있는거지?
  - 아 녀석들은 파일버퍼로 열려있다. 명령창에 ```:ls```를 입력해보자. 그러면 현재 열려 있는 파일들이 보인다.
- 자 이제 또 문제가 생긴다. 도대체 어떻게 다른 파일 버퍼로 이동하지?
  - vim의 기본 명령은 ```b!파일버퍼숫자``` 이렇게 설정되어 있다.
  - 따라서 위의 경우에서 ```b.c```파일로 이동하고 싶다면 ```:b!2```를 입력하면 된다.
  - 하지만 이건 너무 귀찮아... 더 쉬운 방법은 없을까?
  - 있다. 우리가 원하는 단축키로 ```key mapping```을 하면 된다.
  
- ```key mapping```
  - 아래 값들을 ```~/.vimrc``` 파일에 입력해주자.
  ```
  " 파일 버퍼 간 이동
  " 원하는 파일 버퍼로 이동하기
  " 파일 여러개 동시에 편집 작업하는 경우
  map ,` :ls<CR>
  map ,1 :b!1<CR>
  map ,2 :b!2<CR>
  map ,3 :b!3<CR>
  map ,4 :b!4<CR>
  map ,5 :b!5<CR>
  map ,6 :b!6<CR>
  map ,7 :b!7<CR>
  map ,8 :b!8<CR>
  map ,9 :b!9<CR>
  " 다음 파일 버퍼로 이동
  nnoremap <S-l> :bn!<CR>
  " 이 전 파일 버퍼로 이동
  nnoremap <S-h> :bp!<CR>
  ```
- 자 이제는 원하는 파일버퍼로 이동할 때 ```,숫자```로 이동할 수 있게 되었다.
- 그리고 바로 옆의 파일 버퍼로 이동하고 싶다면 ```shift + h 또는 shift + l``` 움직일 수 있다.

-----

##### 2. Ctag - 함수를 보고 싶어!

- 두 번째로 소개하는 기능은 ```ctag```
- 이녀석은 여러 파일을 동시에 작업할 때 파일버퍼 다루는 작업과 더불어 꼭 필요한 기능이다.
- 여러 파일을 동시에 작업하다 보면 당연히 여러 함수들을 다룰 수 밖에 없고, 함수가 어떻게 만들어져 있는지 확인해야 하는 경우가 있다. 
  - 이전까지 나는 무작정 함수가 정의 되어있는 파일을 찾는 방식으로 했다. 이건 너무 비효율적.
  - 어떻게 하면 효율적으로 함수를 볼 수 있을까?
- ```ctags``` 는 바로 이런 경우 아주 유용하게 사용할 수 있다.
- 설치하는 방법은 구글에 매우 많으니까 참고해서 설치하고 키 매핑을 한번 해보자. 아래처럼 키 매핑을 했다.
  ```
  set tags=./tags
  map <C-[> :!ctags -R<CR>
  nnoremap <C-y> <C-]>

  map <F8> :TagbarToggle<CR>
  ```
- 이제 ```Ctrl + h```로 tags 파일을 만들 수 있고, ```Ctrl + j```로 함수를 찾고, ```Ctrl + t```로 다시 돌아 올 수 있다.


-----
##### 3. 키 맵핑

- vim에서 수정된 파일을 저장하기 위해서는 ```<ESC>:w<CR>```를 입력해야 한다. 여간 불편한게 아니다.
- 이 방법을 조금 더 효율적으로 바꿀수는 없을까?
  - 키 매핑을 통해서 바꿔보자.
  
  - 저장
    - ```map ,z <ESC>:w<CR>```, ```:imap ,z <ESC>:w<CR>```
    - 이제 단순히 저장만 하는 경우에는 ```,z```를 타이핑하면 된다. ```insert``` 모드에서도 작동한다.
  
  - 저장 및 닫기
    - ```map ,x <ESC>:wq<CR>```, ```:imap ,x <ESC>:wq<CR>```

  - 라인 바꾸기
    - ```nnoremap <S-j> :m-2<CR>```, ```nnoremap <S-k> :m+1<CR>```
    
-----
##### 4. 치환하기

- [참고사이트](https://vim.fandom.com/wiki/Search_and_replace)

- 모든 문자열 치환
  ```:%s/foo/bar/g```
  
- 정확히 일치하는 단어만 치환
  ```:%s/\<foo\>/bar/g```
  
- Confirm하면서 치환하고 싶은 경우
  ```:%s/foo/bar/gc```

- 라인을 기준으로 바꾸고 싶을 때
  ```:5,12s/foo/bar/g```
  
- 비주얼 표시 된 곳만 바꾸고 싶을 때
  ```Visual + shift + ; -> "'<,'>s/foo/bar/g```

- 정규표현식 응용
  - 특정 문자(abc)로 시작하는 문자열 바꾸고 싶을 때
    ```g/^abc/s/foo/bar/g```j
    
-----    
##### 5. 화면 분할

[참고사이트](https://thoughtbot.com/blog/vim-splits-move-faster-and-more-naturally)

- 여러 파일 수직분할로 동시에 오픈
  ```vim -O *.c```

- 여러 파일 수평분할로 동시에 오픈
  ```vim -o *.c```

- 수직분할
  ```Ctrl + w + v```, ```:vs filename```
  
- 수평분할
  ```Ctrl + w + s```, ```, :sp filename```
 
- 이동
  ```Ctrl + h, j, k, l```
  
- 위, 아래 사이즈 조정
  ```Ctrl + w + "-" or "+"```

- 좌, 우 사이즈 조정
  ```Ctrl + w + > or < ```
  
  
- 분할 화면 닫기
  ```:wq```, ```Ctrl + w + q```
  - 화면을 닫아도 파일버퍼는 남아 있어서 계속 이용할 수 있음. 화면만 없앤거
  
- 현재 창만 남기고 나머지는 지우기
  ```:only```
  
  
  
  
  
  
  
  
  
  
  
